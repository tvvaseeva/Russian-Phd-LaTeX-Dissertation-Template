%% authorvak
\nocite{decomposition_method_application2017}%
\nocite{increased_efficiency2018}
%% authorwos

%
%% authorscopus
\nocite{altman2019cache}%

\section*{Общая характеристика работы}

\newcommand{\actuality}{\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\underline{\textbf{\tasksTXT}}}
\newcommand{\novelty}{\underline{\textbf{\noveltyTXT}}}
\newcommand{\influence}{\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\underline{\textbf{\defpositionsTXT}}}
\newcommand{\reliability}{\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов \dots

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\section*{Содержание работы}
Во \underline{\textbf{введении}} обосновывается актуальность
исследований, проводимых в~рамках данной диссертационной работы,
приводится обзор научной литературы по изучаемой проблеме,
формулируется цель, ставятся задачи работы, излагается научная новизна
и практическая значимость представляемой работы. 
%В~последующих главах сначала описывается общий принцип, позволяющий \dots, а~потом идёт апробация на частных примерах: \dots  и~\dots.

\underline{\textbf{В первой главе}} изложено %\dots
математические основы построения алгоритмов оценки параметров гармоник.

Объектом исследования являются алгоритмы оценки параметров гармоник. Предметом иследования является точность и быстродействие алгоритмов оценки параметров гармоник. Мы изучаем оценку параметров гармоник на примере сигналов в электрической сети.

В работе представлена математическая модель сигнала в электрической сети, обобщающая результаты исследований проблем качества электроэнергии (КЭ) и учитывающая требования регламентирующих документов. Она позволяет проводить исследования алгоритмов анализа электрических сигналов, а также средств измерений, построенных на их основе.
Модель сигнала электрической сети связывает гармоники, высшие гармоники и интергармоники тока и напряжения электрической сети при наличии шума: 
%ГОСТ 30804.4.7-2013 (IEC 61000-4-7:2009) Совместимость технических средств электромагнитная. Общее руководство по средствам измерений и измерениям гармоник и интергармоник для систем электроснабжения и подключаемых к ним технических средств. 2013; Доступно по: http://docs.cntd.ru/document/1200103652
\begin{equation}
	\label{eq:equation1}
	s_{t} = a_{0} \sin (\omega_{0} t + \varphi_{0}) + \displaystyle\sum_{p=0}^{P} a_p^{\upsilon} \sin (m_p^{\upsilon} \omega_{0} t + \varphi_p^{\upsilon}) + \displaystyle\sum_{q=0}^{Q} a_q^i \sin  (\omega_q^i t + \varphi_q^{i})
\end{equation}

где $a_{0}$ – амплитуда первой гармоники;

$\omega_{0}$ – угловая частота первой гармоники, $\omega_{1} = 2 \pi f_{H,1}$;

$\varphi_{0}$ – фаза первой гармоники; 

$p$ – число высших гармоник;

$P$ – максимальное число высших гармоник;

$a_p^{\upsilon}$ – амплитуда высших гармоник;

$m_p^{\upsilon}$ – номер высших гармоник;

$\varphi_p^{\upsilon}$ – фаза высших гармоник;

$q$ – номер интергармоник;

$Q$ – максимальный номер интергармоник;

$a_q^i$ – амплитуда интергармоник;

$\omega_q^i$ – угловая частота интергармоник, $\omega_q^i=2\pi f_{ig,h}$; 

$f_{ig,h}$ – частота интергармонической подгруппы порядка $h$;

$\eta$ – шум.

Проблема измерения гармоник и интергармоник в электрической сети является актуальной.
Наличие интергармоник и гармоник оказывает негативное влияние на оборудование. Из-за возникновения гармоник в электрических сетях происходит перегрев оборудования, поэтому уменьшается его срок службы. Интергармоники наблюдаются при увеличении количества нагрузок в дополнение к гармоникам.

Особенности сигналов в электрических сетях носят не существенный характер с точки зрения построения алгоритмов нахождения параметров гармоник. При работе с электрическими сетями обычно используют стандартные алгоритмы такого рода. 
% Раздел <<Концепция определения гармоник>>.

Помимо обычных алгоритмов для оценки параметров гармоник в электрических сетях также используют алгоритмы, анализирующие сигналы в переходных режимах, т.~е. такие, в которых во время работы алгоритма может измениться значение какого-либо параметра. В нашей работе такие алгоритмы далее рассматриваться не будут, поскольку переходные режимы не являются целью нашей работы;
% Нет в диссертации

Анализ имеющихся библиографических источников показывает, что нет известных публикаций, в которых бы велась разработка алгоритмов, ориентированных на работу при определенном соотношении сигнал-шум, и что для анализа гармоник и интергармоник (для которых это соотношение отличается) применяются одинаковые алгоритмы; 
% Разделы <<Обзор обнаружения и измерения гармоник в энергосистеме>> и <<Улучшенный алгоритм частоты путем развертывания фазы методом наименьших квадратов>>.

Точность получаемых результатов оценки параметров гармоник можно проверить с помощью неравенства Крамера-Рао. В зарубежной литературе чаще встречается термин Cramer-Rao lower bound (CRLB), что обозначает <<нижняя граница Крамера-Рао>>. 

В неравенстве Крамера-Рао сигнал имеет наибольшую величину дисперсии при некоторых условиях. Если неравенство Крамера-Рао преобразуется в равенство, то оценка параметров считается наилучшей. Отсюда следует, что дисперсия данной оценки самая маленькая из возможных. Таким образом, данная оценка лучше всех остальных, и метод с такой дисперсией обладает наилучшей точностью. Несмещенная оценка, которая достигается нижней границей Крамера-Рао, называется эффективной. Такое решение обеспечивает наименьшую среднеквадратичную ошибку среди несмещенных методов и называется minimum variance unbiased (MVU)~--~<<оценкой с минимальной несмещенной дисперсией>>. Общая формула границы Крамера-Рао:
\begin{equation}
	\label{eq:equation2}
	var(\theta)\geq\frac{1}{I(\left.\theta)\right]}
\end{equation}

где $I(\theta)=-E\left[\frac{\delta^2 ln p(x;\theta)}{\delta\theta^2}\right]$ -- количество информации по Фишеру, получаемой в результате наблюдения.

В результате анализа, произведенного в первом разделе, можно сделать следующие выводы:
алгоритмы оценки параметров гармоник, применяемые при работе с однотональными и многотональными сигналами, имеют точность оценки параметров ниже теоретической границы Крамера-Рао. Вопрос о причинах снижения точности и возможности построения алгоритма, достигающего этой границы в известных научных публикациях не рассмотрен; 
% Раздел <<Нижняя граница Крамера-Рао>>
для решения задачи построения оптимального алгоритма для анализа спектра сигнала в электрических сетях необходимо уточнение математической модели спектра сигналов в части, описывающей точность оценки (дисперсию) параметров гармоник спектра многотонального сигнала. 
% Формула \ref{eq:equation6}, раздел <<Модель сигнала электрической сети>>.

\underline{\textbf{Вторая глава}} посвящена математическим основам построения алгоритмов оценки параметров гармоник.
Высокую точность оценки спектральных составляющих сигнала может
обеспечить ЦОС, в этом случае его математической
основой является БПФ. Однако применение ДПФ не позволяет точно оценить параметры гармоник сигнала, когда
максимум ДПФ не совпадает с максимумом спектра. Рассмотрим формулу модели сигнала:	
\begin{equation}
	\label{eq:equation3}
	s(t) = \displaystyle\sum_{k=0}^{N-1} A_k \cos \left({\frac{2 \pi}{T_s} f_{peak} t  + \varphi_k} \right)+ \eta(t)  
\end{equation}

где $A_k$ -- амплитуда;

$f_{peak}$ -- частота;

$\varphi_k$ -- начальная фаза;

$\eta(t)$ -- шум. 

Если представить аналоговый сигнал в дискретной форме, то 
максимум гармоники сигнала $f_{peak}$ и максимум дискретных гармоник $f_k$ будут не совпадать (рисунок \ref{img:Maximum_DFT}). ДПФ можно представить в комплексной форме:
\begin{equation}
	\label{eq:equation4}
	\dot{X}(n)= \displaystyle\sum_{k=0}^{N-1} x(k) \cdot \exp\left( -j \cdot \frac{2 \pi n k}{N}\right)
\end{equation}  

После Быстрого Преобразования Фурье на рисунке \ref{img:Maximum_DFT} видим дискретные гармоники $f_k-1$, $f_k$, $f_{k+1}$ и амплитудные гармоники $|X_{k-1}|$, $|X_k|$, $|X_{k+1}|$. Исследуемая математическая модель сигнала показывает соотношение между реальными гармониками и теми, которые мы получаем после использования ДПФ. 

\begin{figure}[h]
	\centering
	\includegraphics [scale=0.25] {Maximum_DFT.pdf}
	\begin{flushright}
		\caption{Случай несовпадения максимума ДПФ и максимума спектра гармоник.}	
	\end{flushright}
	\label{img:Maximum_DFT}
\end{figure}

Для нахождения $f_{peak}$ исследованы методы оценки спектральных составляющих в диссертационной работе: метод Якобсена (Jacobsen's Modified Quadratic Estimator), два метода Квина (Quinn's Estimator, Quinn's Second Estimator), два метода Маклеода (Macleod's Estimator), метод Грэндка (Grandke's method), алгоритм параболической интерполяции (Parabolic Interpolation), алгоритм интерполяции Гаусса (Gaussian Interpolation), алгоритм, рекомендованный в ГОСТ 30804.4.7-2013, метод корреляционных функций (Correlation function method), модернизированный метод корреляционных функций (Modernized method of correlation functions).
%B. G. Quinn, "Estimation of frequency, amplitude, and phase from the DFT of a time series," in IEEE Transactions on Signal Processing, vol. 45, no. 3, pp. 814-817, March 1997, doi: 10.1109/78.558515.
% B. G. Quinn, "Estimating frequency by interpolation using Fourier coefficients," in IEEE Transactions on Signal Processing, vol. 42, no. 5, pp. 1264-1268, May 1994, doi: 10.1109/78.295186.
% B. G. Quinn and P. J. Kootsookos, "Threshold behavior of the maximum likelihood estimator of frequency," in IEEE Transactions on Signal Processing, vol. 42, no. 11, pp. 3291-3294, Nov. 1994, doi: 10.1109/78.330402.

% D. Rife and R. Boorstyn, "Single tone parameter estimation from discrete-time observations," in IEEE Transactions on Information Theory, vol. 20, no. 5, pp. 591-598, September 1974, doi: 10.1109/TIT.1974.1055282.
% M. D. Macleod, "Fast nearly ML estimation of the parameters of real or complex single tones or resolved multiple tones," in IEEE Transactions on Signal Processing, vol. 46, no. 1, pp. 141-148, Jan. 1998, doi: 10.1109/78.651200.


%T. Grandke, "Interpolation Algorithms for Discrete Fourier Transforms of Weighted Signals," in IEEE Transactions on Instrumentation and Measurement, vol. 32, no. 2, pp. 350-355, June 1983, doi: 10.1109/TIM.1983.4315077.

%Konopatskiy E. V., Bezditnyi A. A. Geometric modeling of multifactor processes and phenomena by the multidimensional parabolic interpolation method //Journal of Physics: Conference Series. – IOP Publishing, 2020. – Т. 1441. – №. 1. – С. 012063.
% S. Djukanović, T. Popović and A. Mitrović, "Precise sinusoid frequency estimation based on parabolic interpolation," 2016 24th Telecommunications Forum (TELFOR), 2016, pp. 1-4, doi: 10.1109/TELFOR.2016.7818824.


% Gasior M., Gonzalez J. L. Improving FFT frequency measurement resolution by parabolic and Gaussian spectrum interpolation //AIP Conference Proceedings. – American Institute of Physics, 2004. – Т. 732. – №. 1. – С. 276-285.
% Gu X., Du JX., Wang XF. (2005) Leaf Recognition Based on the Combination of Wavelet Transform and Gaussian Interpolation. In: Huang DS., Zhang XP., Huang GB. (eds) Advances in Intelligent Computing. ICIC 2005. Lecture Notes in Computer Science, vol 3644. Springer, Berlin, Heidelberg. https://doi.org/10.1007/11538059_27
% Gilboa E. et al. Image interpolation and denoising for division of focal plane sensors using Gaussian processes //Optics express. – 2014. – Т. 22. – №. 12. – С. 15277-15291.

% Альтман Е. А., Елизаров Д. А. Повышение точности оценки параметров сигналов в электрической сети в системе тягового электроснабжения //Известия Транссиба. – 2012. – №. 3 (11).
% Wang Z. et al. Nonlinearity-tolerant OSNR estimation method based on correlation function and statistical moments //Optical Fiber Technology. – 2017. – Т. 39. – С. 5-11.

% Елизаров Д. А. Анализ методов оценки гармонических составляющих напряжения в электроэнергетических системах //Омский научный вестник. – 2016. – №. 2 (146).

Алгоритмы  для нахождения параметров гармоник являются интерполяционными, кроме трех последних методов (метод корреляционных функций, модернизированный метод корреляционных функций и метод по ГОСТу). Сутью метода интерполирования является нахождение промежуточных значений величины по имеющемуся дискретному набору известных значений, то есть кривая построенной функции должна точно пройти через имеющиеся точки данных.

На рисунке \ref{img:Dispersion_in_the_estimation_of_the_fundamental_frequency_of_the_voltage} представлена зависимость дисперсии оценки основной частоты от уровня шума. Представлены методы: граница Крамера-Рао, метод корреляционных функций, второй метод Квина, метод Маклеода (5 точек). В результате анализа выявлено, что метод корреляционных функций наиболее точен, но использует большее количество математических операций, поэтому требует большего времени на выполнение.  
\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.7] {Dispersion in the estimation of the fundamental frequency of the voltage.pdf}
	\caption{Дисперсия при оценке основной частоты напряжения.}
	\label{img:Dispersion_in_the_estimation_of_the_fundamental_frequency_of_the_voltage}
\end{figure}

Как видно из рисунка	\ref{img:Dispersion_in_the_estimation_of_the_fundamental_frequency_of_the_voltage} рассмотренные методы не позволяют находить эффективную несмещенную оценку параметров гармоник. Для нахождения таких оценок было предложено использование прямого корреляционного метода. Возникающие при этом вопросы вычисления эффективности алгоритмов рассмотрим в 3 главе.

Нижняя граница Крамера-Рао является объективным показателем для
определения границы дисперсии ошибки при оценке неизвестного параметра при
использовании различных методов. Общая оценка границы Крамера-Рао для сигналов в белом Гауссовом шуме определяется:
\begin{equation}
	\label{eq:equation5}
	x[n] = A + s[n;\theta] + w[n], n=0,1,...,N-1	
\end{equation}

где $x[n]$ -- среднее значение;

$A$ и $\theta$  -- оцениваемые параметры;

$w[n]$ -- белый шум Гаусса;

$s[n;\theta]$ -- детерминированный сигнал.

\begin{equation}
	\label{eq:equation6}
	var(\hat{\theta}) \geq \frac{\sigma^2}{\displaystyle\sum_{n=0}^{N-1} \left(\frac{\partial s [n; \theta]}{\partial\theta}\right)^2} 
\end{equation}

Форма границы Крамера-Рао демонстрирует зависимость от оцениваемого параметра $\theta$.
Для параметров гармоник сигнала неравенство Крамера-Рао выглядит следующим образом:
%(3.41), C.34
\begin{equation}
\label{eq:equation7}
var(\hat{A})\geq \frac{2  \sigma^2}{N}, var(\hat{\varphi})\geq \frac{2(2N-1)}{\eta N(N+1)}, var(\hat{f_0})\geq \frac{12}{(2\pi)^2 \eta  N(N^2 - 1)}    
\end{equation}

где $var(\hat{A})$ -- дисперсия амплитуды;
$var(\hat{\varphi})$ -- дисперсия фазы гармоник; 
$var(\hat{f_0})$ -- дисперсия частоты.


Экспериментальная проверка формулы 	\ref{eq:equation7} с помощью прямого корреляционного метода показала расхождением с теоретическими данными. Результаты прямым корреляционным методом имели более высокую дисперсию оценок. Была высказана гипотеза, что данная ошибка связана с тем, что граниица Крамера-Рао не учитывает влияние оконной функции. Для подтверждения этой гипотезы была выведена новая формула границы Крамера-Рао для амплитуды с учетом оконных функций.
 
При наблюдении за дискретным сигналом, на который накладывается аддитивный белый гауссовский шум, формула \ref{eq:equation2} может быть записана в виде: 
\begin{equation}
	\label{eq:equation8}
	var(\theta)\geq\frac{\sigma^2}{\sum_{n=0}^{N-1}\left(\frac{\delta x(n;\theta)}{\delta\theta}\right)^2}
\end{equation}

где $\sigma $ -- среднее квадратичное отклонение шума;

N -- число отсчетов в дискретном сигнале;

$x(n;\theta)$ -- наблюдаемый сигнал.

В нашем случае наблюдаемый сигнал описывается следующей формулой:
\begin{equation}
	\label{eq:equation9}
	x_n=A\cos(2*\pi*f*n+\phi)+wgn_n, n\in0,…,n-1
\end{equation}

где $A$ -- амплитуда сигнала;

$f$ -- частота;

$\phi$ -- фаза;

$wgn$ -- белый гауссовский шум.

Этот сигнал содержит три неизвестных параметра (амплитуду, частоту и фазу). Пренебрегая неопределенностью частоты и фазы получим следующую формулу для дисперсии оценки амплитуды гармоники в аддитивном белом гауссовском шуме: 

\begin{equation}
	\label{eq:equation10}
	I(A)=\sum_{n=0}^{N-1}\left( \frac{\delta x}{\delta A} \right)^2 =\frac{1}{\sigma^2} \sum_{n=0}^{N-1}\cos^2 (2*\pi*f*n+\phi)\approx \frac{N}{2\delta ^2 }
\end{equation}

После применения оконной функции сигнал будет записан в виде: 

\begin{equation}
	\label{eq:equation11}
	x_n^{'}= w_n*A\cos(2*\pi*f*n+\phi)+w_n*wgn_n,..n\in 0,…,n-1
\end{equation}

где $w$ -- оконная функция.

Изменения дисперсии шума:
\begin{equation}
\label{eq:equation12}
w g N_i = w_i \cdot w g N_i
\end{equation}

\begin{equation}
	\label{eq:equation13}
{\sigma^2}' = (w_i \cdot w g N_i - 0)^2=(w_i \cdot w g N_i)^2 =\frac{\displaystyle\sum_{i=1}^{N-1} w_i^2}{N} \cdot \sigma^2
\end{equation}

Усредняя по всем $n$ получаем, что дисперсия случайной величины $w_n*wgn_n$ будет: 

\begin{equation}
	\label{eq:equation14}
	\sigma^{'2}=\frac{\sum_{n=0}^{N-1} w_n^2}{N}*\sigma^2
\end{equation}

Если величина $\alpha$, которую нужно оценить, связана с величиной $\theta$, для которой известна граница Крамера-Рао, соотношением $\alpha=g(\theta)$, то границу Крамера-Рао для величины $\alpha$ можно найти по формуле: 

\begin{equation}
	\label{eq:equation15}
	var(\theta)\geq \frac{\left(\frac{\delta^2 g}{\delta\theta}\right)}{-E\left[\frac{\delta^2 ln p(x;\theta)}{\delta \theta^2}\right]^{'}}
\end{equation}

Умножение сигнала на оконную функцию приводит к сворачиванию каждой гармоники сигнала со спектром оконной функции. В случае единственной гармоники ее амплитуда умножается на нулевую гармонику спектра оконной функции. Нулевая гармоника сигнала это постоянная составляющая, ее значение для оконной функции можно найти по формуле: 

\begin{equation}
	\label{eq:equation16}
	w_0= \frac{\sum_{n=0}^{N-1} w_n}{N}.	  
\end{equation}

Получаем, что: 
\begin{equation}
	\label{eq:equation17}
	A^{'}=\frac{A}{w_0} ,		  
\end{equation}

где $A$ -- амплитуда гармоники, полученная в результате оценки умноженного на оконную функцию сигнала; 

$A^{'}$ -- амплитуда гармоники исходного сигнала.

В нашем случае величина $\theta$ с известной границей Крамера-Рао это A, величина $\alpha$ с неизвестной границей это  $A^{'}$ , $g(\theta)=\frac{\theta}{w_0}, \left(\frac{\delta^2 g}{\delta \theta}\right)^2=\frac{1}{w_0^2}$.

Основное положение, которое выносится на защиту -- это дополнение математической модели многотонального сигнала, позволяющего определять дисперсию оценки амплитуды гармоники, отличающее от известной границы Крамера-Рао с учетом изменения дисперсии после применения оконных функций. Математическая модель для оценки точности нахождения амплитуды гармоники:
\begin{equation}
	\label{eq:equation18}
	var(A)\geq \frac{2\sigma^2}{N} \frac{\sum_{n=0}^{N-1}w_n^2}{\left(\sum_{n=0}^{N-1} w_n \right)^2} 			  
\end{equation}

где $\sigma$ -- среднее квадратичное отклонение шума;

$n$ – номер отчета.

$N$ – число отсчетов в дискретном сигнале;

$x(n;\theta)$ – наблюдаемый сигнал;

$A$ – амплитуда гармоники. 

Эта формула дает оценку дисперсии при использовании метода, вносящего оптимальную несмещенную оценку. В работе \cite{altman2020boundary} ввели новое обозначение коэффициент окна:
\begin{equation}
	\label{eq:equation19}
	F_{win}=\frac{\sum_{n=0}^{N-1}w_n^2}{\left(\sum_{n=0}^{N-1} w_n\right)^2}
\end{equation}

Данный коэффициент показывает, во сколько ухудшится оценка амплитуды гармоники при использовании окна $w$.

Эксперименты для проверки полученных формул были проведены при различных входных параметрах (число точек, амплитуда, частота и фаза сигналов, дисперсия шума или коэффициент окна). Ни в одном случае не было зафиксировано отклонение результатов эксперимента от результатов, полученных по предложенной формуле. 

Разработан комплекс программ на языке программирования Python: оценка дисперсии белого шума после наложения на него окна, оценка амплитуды при использовании разных окон, оценки амплитуды при различных уровнях шума.
На рисунке \ref{img:noise_win_var} показано изменение дисперсии шума после наложении на него окна Кайзера, результаты расчета по формуле \ref{eq:equation7}. Из графика видно, что линии дисперсий практически совпадают.
\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.5] {noise_win_var.png}
	\caption{\small{Зависимость дисперсии шума после наложении на него окна.}}
	\label{img:noise_win_var}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.5] {estimate_amp_sin_kaiser_beta.png}
	\caption{\footnotesize{Зависимость дисперсии оценки амплитуды от параметра окна.}}
	\label{img:estimate_amp_sin_kaiser_beta}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.5] {estimate_amp_sin_kaiser_noise.png}
	\caption{\footnotesize{Зависимость дисперсии оценки амплитуды от дисперсии шума.}}
	\label{img:estimate_amp_sin_kaiser_noise}
\end{figure}

Дальнейшие исследования влияния оконных функций на формулу для нахождения границы Крамера-Рао рассмотрены в статье \cite{altman2021boundary}.
В статье изучили весовые функции: Кайзера, Барлетта, Ханна, Хэмминга, Блэкмана (результаты приведены в таблице \ref{tbl:test2_1}). Формула для оценки дисперсии амплитуды дает наилучший результат с весовыми функциями: Кайзера ($\beta=4$), Хэмминга, Барлетта. Совпадение дисперсий оценок прямого корреляционного метода и оценок, полученных по формуле показывают, что чем меньше коэффициент увеличения дисперсии, тем точнее результаты. Наихудший результат показало окно Кайзера с параметром $\beta=15$ \ref{eq:equation19}.
\begin{table}[ht]%
	\caption{Зависимость дисперсии оценки амплитуды от дисперсии шума.}
	\label{tbl:test2_1}
	\fontsize{10pt}{10pt}\selectfont
	\begin{longtable*}[c]{|c|c|}  
		\hline
		Окно &
		Коэффициент увеличение дисперсии  \\
		\hline			
		Кайзера ($\beta=4$) & $1.24672$ \\
		\hline
		Кайзера ($\beta=7$) & $1.56900$ \\
		\hline
		Кайзера ($\beta=10$) & $1.84508$ \\
		\hline
		Кайзера ($\beta=15$) & $2.23330$ \\
		\hline
		Барлетта (треугольное окно) & $1.33333$ \\
		\hline
		Ханна (Хеннинга) & $1.50000$ \\
		\hline 
		Хэмминга & $1.36282$ \\
		\hline
	\end{longtable*}%
\end{table}

В результате анализа, произведенного во втором разделе, можно сделать следующие выводы:
применение оконной функции уменьшает количество информации, получаемое из сигнала, и, как следствие, увеличивается дисперсия оценки параметров сигнала, или, другими словами, ухудшается точность оценки параметров сигналов;
% Раздел <<Нижняя граница Крамера-Рао>>
ухудшение точности оценки можно определить исходя из предложенного в главе коэффициента окна. Данный коэффициент показывает, насколько уменьшиться точность оценки амплитуды гармоники для оптимальной несмещенной оценки при применении такого окна, а также может использоваться для оценки снижения точности параметров;
% Раздел <<Нижняя граница Крамера-Рао>>
алгоритмы для нахождения оптимальной несмещенной оценки параметров могут быть построены на основе методов оптимального приема, изучаемых в радиотехники, в частости, с помощью корреляционного анализа.
% Раздел <<Корреляция>>

\underline{\textbf{Третья глава}} посвящена исследованию численных методов для нахождение оптимальной несмещенной оценки параметров гармоник.

Методы, основанные на интерполировании смежных гармоник, позволяют достичь высокой точности, во многих случаях достаточной для практического применения, однако они не позволяют достичь точности оптимальной несмещенной оценки.

Оценка параметров гармоник прямым корреляционным методом подразумевает вычисление корреляций сигнала с гармоническим сигналом различной частоты. Расстоянием между частот эталонных гармоник, а следовательно, и количество вычисляемых корреляций, можно определить с помощью границы Крамера-Рао. Для определения числа гармоник и расстояния между ними в зависимости от сценария использования алгоритмов оценки параметров в работе был предложен следующий подход.

При заданной точности по частоте используем формулу \ref{eq:equation20}:
\begin{equation}
\label{eq:equation20}
k_i=\frac{f_1}{f_{eps}}
\end{equation} 

${f_{eps}}$ -- заданная точность.

При заданной точности по амплитуде используем формулу \ref{eq:equation21}:
\begin{equation}
\label{eq:equation21}
f_{eps}=a_{eps}*\frac{sw_0-w_i}{sw_0} 
\end{equation} 

$a_{eps}$ -- заданная точность;

$sw_i$ -- отсчеты спектра окна.

При заданном уровне шума используем формулу \ref{eq:equation22}:
\begin{equation}
\label{eq:equation22}
a_{eps} = var(A)\geq \frac{2\sigma^2}{N}  \frac{\sum_{n=0}^{N-1}w_n^2}{\left(\sum_{n=0}^{N-1} w_n \right)^2}
\end{equation} 

Для вычислительно эффективного нахождения большого числа гармоник в нашем случае могут быть использованны следующие подходы:
\begin{itemize}
\item использование метода дополнения исходного сигнала нулями и быстрое нахождение сигнала с помощью специальных алгоритмов БПФ;

\item предварительная оценка частоты гармоники с помощью быстрого преобразования Фурье и нахождения гармоник, находящихся между отчетами БПФ, с помощью интерполирования (с некоторой потерей в точности);

\item предварительная оценка частоты гармоники с помощью быстрого преобразования Фурье и нахождения гармоник, находящихся между отчетами БПФ, с помощью быстрых методов вычисления корреляции;

\item использование итерационного оптимизационного метода нахождения гармоник на основе чисел Фиббоначи;
\item комбинации рассмотренных методов.
\end{itemize}

В диссертационной работе были проанализированны все эти подходы.

Анализ литературных источников показал, что для нашей задачи могут использоваться такие специальные алгоритмы БПФ как разряженное БПФ (sparse FFT) и усеченное БПФ (pruned FFT) (в виду неоднозначности и путаницы в применямых в научных статьях на русском языке названий этих алгоритмов, далее везде будем указывать английские варианты терминов).

Алгоритм Sparse FFT показал высокое быстродействие, его время работы было меньше, чем при использовании интерполяционных методов. Однако, он показал свою неработоспособность в сочетании с методом дополнения исходного сигнала. Анализ алгоритма показал, что эта проблема является принципиальной, посколько связана с основной идеей этого алгоритма -- поиск наибольших гармоник.

Применение алгоритмов БПФ началось после публикации работы Джеймса Кули (James Cooley) и Джона Тьюки (John Tukey) в $1965$ году. Для вычисления БПФ используют алгоритм Кули-Тьюки в котором умножаются поварачивающие множители и вычисляются строки БПФ.

Рассмотрим матрицу с шириной столбцов $N$ и высотой столбцов $K$. Алгоритм Pruned FFT реализуется следующим способом: он не требует $1$-й стадии вычислений, cложность алгоритма составляет  $N \cdot \log(N) \cdot K$, сложность алгоритма растет линейно с ростом $K$.
Наиболее распространенный случай, когда используется Pruned FFT, -- это свертки с нулевым заполнением, где примерно 50\% входных данных равны нулю (чтобы получить линейную свертку из циклической свертки на основе БПФ).

\begin{center}
$\longrightarrow N$	
\end{center}
\begin{equation}
	\label{eq:equation23}
	\downarrow K 
	\begin{pmatrix}
			X_{0} & X_{1} & \cdots & X_{n-1} \\
			X_{N} & X_{n+1} & \cdots & X_{2n-1} \\
			\vdots  & \vdots  & \ddots & \vdots  \\
			X_{N(k-1)} & \cdots & \cdots & X_{N(k-1)} 
		\end{pmatrix}
		\Bigg \} {\text{НУЛИ}}
\end{equation} 

\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.5] {Pruned_FFT.pdf}
	\caption{Исходный сигнал.}
	\label{img:Pruned_FFT}
\end{figure}

Для нахождения параметров промежуточных гармоник с помощью быстрых алгоритмов корреляции используется формула:
\begin{equation}
	\label{eq:equation24}
	A_j = 
	\displaystyle\sum_{k=0}^{M-1} x(k) \cdot \exp \left( -f_j \cdot \frac{2 \pi k}{N}\right) 
\end{equation}

где $j = 0, 1, \cdots M-1$;

$f_j$ -- частота гармоники ДПФ, $f_j = \frac{\left| f_{max}- f_{max'} \right| }{M} + f_{max'}$;

$f_{max}$ -- частота гармоники ДПФ с наибольшей амплитудой;

$f_{max}'$ -- частота гармоники ДПФ со 2 по величине амплитуде.

\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.7] {Using_correlation.pdf}
	\caption{Использование корреляции.}
	\label{img:Using_correlation}
\end{figure}

На рисунке \ref{img:Using_correlation} показано использование корреляции. Из-за диапазона в частотах гармоник ДПФ $f_{max}$ и $f_{max}'$  мы получаем дополнительные амплитудные гармоники $A'$ (формула \ref{eq:equation24}), которые показаны на рисунке синей пунктирной линией со звездочками.

В результате анализа, произведенного в третьем разделе, можно сделать следующие выводы:
реализация метода дополнения нулями сигнала при использовании усеченного преобразования Фурье имеет быстродействие менее чем на порядок худшее, чем итерационные и оптимизационные методы, при этом быстродействие не зависит от числа обсчитываемых гармоник. Также нужно отметить больший объем памяти, требуемый для этого метода, который при этом не является критичным для современных вычислительных устройств;
метод дополнения нулями может быть реализован с помощью усеченного преобразования Фурье (pruned FFT) либо с помощью быстрых методов вычисления корреляции. То, какая реализация будет вычислительно эффективней, зависит от соотношений числа точек в представлении сигнала, требуемой точности по частоте и количеству гармоник для которых определяются параметры. Выбор реализации в данном случае следует определять экспериментально;
производительности современной вычислительной техники в большинстве случаев оказывается достаточно для использования прямого корреляционного метода с применением быстрых вычислительных алгоритмов.

%Можно сослаться на свои работы в автореферате. Для этого в файле
%\verb!Synopsis/setup.tex! необходимо присвоить положительное значение
%счётчику \verb!\setcounter{usefootcite}{1}!. В таком случае ссылки на
%работы других авторов будут подстрочными.
%Изложенные в третьей главе результаты опубликованы в~\cite{vakbib1, vakbib2}.
%Использование подстрочных ссылок внутри таблиц может вызывать проблемы.

В \underline{\textbf{четвертой главе}} приведено описание применения алгоритмов оценки параметров многотональных сигналов для анализа гармоник и интергармоник в электрических сетях на железнодорожном транспорте.

В современных стандартах по анализу спектра в электрических сетях большее внимание уделяется нахождению интергармонических составляющих. Поскольку интергармонические составляющие имеют малую энергию по отношению к другим гармоникам и шуму, к алгоритмам для нахождения параметров гармоник возрастают требования по точности определения амплитуды в условиях высокого шума.

В стандартах также указывается требования о нахождение всех гармоник по 40 включительно, что, вместе с требованием о нахождении интеграмоник приводит к большому числу анализируемых гармонических составляющих сигнала.

Исходя из требований стандарта и анализа свойств изученных алгоритмов для анализа спектра сигнала в силовых электрических сетях железнодорожного транспорта рекомендуется использование метода дополнения сигнала нулями с применением разряженного преобразования Фурье.

В результате анализа был предложен метод нахождения параметров всех гармоник многотонального сигнала в соответствии с моделью сигнала в первой главе. Алгоритм поиска гармоник представлен на рисунке: \ref{img:Diagram_GSA}. На основании алгоритма зарегистрирована программа для расчета гармоник и интергармоник тока и напряжения электрической сети прямым корреляционным методом с использованием быстрых алгоритмов обработки сигналов. 

\begin{figure}[ht]
	\centering
	\includegraphics [scale=0.45] {Diagram_GSA2.png}
	\caption{ГСА алгоритма поиска гармоник.}
	\label{img:Diagram_GSA}
\end{figure}

Основные три части программы -- это блок поиска гармоник, блок оценки параметров гармоник и блок моделирования алгоритмов поиска и оценки параметров.

Блок поиска гармоник находит частоты гармоник исходя из заданных коэффициентов определяющих минимальные уровень гармоник и расстояние между гармониками. Эти коэффициенты могут определяться в процессе моделирования.

Блок оценки параметров используют алгоритмы, описанные во второй и третьей главах.

Предложенная программа была проверена на данных измерений сигналов в электрических сетях, полученных другими исследователями, и показала свою работоспособность.

В результате анализа, произведенного в четвертом разделе, можно сделать следующие выводы -- время расчета спектра реального сигнала этим методом на современном компьютере начального уровня составляет единицы секунд, что позволяет говорить о его приемлемом быстродействии для решения практических задач.	

\section*{Заключение}
\input{common/concl}

%При использовании пакета \verb!biblatex! список публикаций автора по теме
%диссертации формируется в разделе <<\publications>>\ файла
%\verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
  \renewcommand{\bibname}{\large \bibtitleauthor}
  \nocite{*}
  \insertbiblioauthor           % Подключаем Bib-базы
  %\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
  % Цитирования.
  %  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
  %  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
  %  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
  %


  %
  %% authorconf 16 штук
%  \nocite{detectors_local2016}
%  \nocite{boundary_recognition2017}
%  \nocite{innovative_projects2017}
%  \nocite{implementation_of_algorithms2017}
%  \nocite{information-measuring2018}
%  \nocite{efficiency_mark2018}
%  \nocite{accuracy_study2018}
%  \nocite{depth_expansion2018}
%  \nocite{application_of_fast2018}
%  \nocite{cache_oriented2019}
%  \nocite{comparative_analysis_2019}
%  \nocite{comparative_analysis2019}
%  \nocite{modern_information2019}
%  \nocite{complexity_assessment2019}
%  \nocite{comparative_study2020}
%  \nocite{altman2021boundary}
  %
  %% 
%  % nir-отчет НИР
  \nocite{Malyutin2018Mathematical}
  \nocite{Malyutin2019Mathematical}
  \nocite{Malyutin2019Improvement}
  \nocite{Malyutin2020Mathematical}
%  
%  %program - программа ЭВМ
  \nocite{altman2019program}	

  \ifnumgreater{\value{usefootcite}}{0}{
    \begin{refcontext}[labelprefix={}]
      \ifnum \value{bibgrouped}>0
        \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
      \else
        \insertbiblioauthor      % Вывод всех работ автора
      \fi
    \end{refcontext}
  }{
  \ifnum \value{citeexternal}>0
    \begin{refcontext}[labelprefix=A]
      \ifnum \value{bibgrouped}>0
        \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
      \else
        \insertbiblioauthor      % Вывод всех работ автора
      \fi
    \end{refcontext}
  \else
    \ifnum \value{bibgrouped}>0
      \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
    \else
      \insertbiblioauthor      % Вывод всех работ автора
    \fi
  \fi
  %  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
  \begin{refcontext}[labelprefix={}]    \insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
  \end{refcontext}
  }
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
